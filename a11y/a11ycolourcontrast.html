<!DOCTYPE html>
<html lang="en">
<head>
  <!-- 		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> -->
  <meta charset="utf-8"/>
  <meta name="author" content="CorporateTool.Net"/>
  <meta name="Keywords" content="accessibility color contrast html aria WCAG"/>
  <meta name="Description" content="A test web page for color contrast accessibility testing"/>
  <meta name="robots" content="all"/>
  <meta name="docref" content="a11y contrast color test - a11ycolorcontrast.html"/>
  <title aria-label="Accessibility Colour Contrast Test Page - CorporateTool dot Net">Accessibility Colour Contrast Test Page -
    CorporateTool.Net</title>
  <link type="image/vnd.microsoft.icon" rel="shortcut icon" href="/resources/images/favicon.ico"/>
  <link type="image/vnd.microsoft.icon" rel="icon" href="/resources/images/favicon.ico"/>
  <script>

    let bgColor = '';
    let fgColor = '';
    let fgOpacity = 1;
    let fontColor = '';
    function updateColors() {
      const backgroundColorDisplay = document.getElementById('backgroundColorDisplay');
      const foregroundColorDisplay = document.getElementById('foregroundColorDisplay');
      const fontTextDisplay = document.getElementById('fontTextDisplay');
      const fontColorDisplay = document.getElementById('fontColorDisplay');

      colorInputs.forEach(function(colorInput) {
        console.log(colorInput);
        switch (colorInput.id) {
          case 'backgroundColor':
            console.log('backgroundColor', colorInput.value);
            // if (colorInput.value) {
            backgroundColorDisplay.style.backgroundColor = colorInput.value;
            bgColor = colorInput.value;
            // }
            break;
          case 'foregroundColor':
            console.log('foregroundColor', colorInput.value);
            foregroundColorDisplay.style.backgroundColor = colorInput.value;
            fgColor = colorInput.value;
            break;
          case 'foregroundOpacity':
            console.log('foregroundOpacity', colorInput.value);
            foregroundColorDisplay.style.opacity = colorInput.value;
            fgOpacity = colorInput.value;
            break;
          case 'fontColor':
            console.log('foregroundColor', colorInput.value);
            fontTextDisplay.style.color = colorInput.value;
            fontColorDisplay.style.backgroundColor = colorInput.value;
            fontColor = colorInput.value;
            break;
          case 'fontOpacity':
            console.log('foregroundOpacity', colorInput.value);
            fontTextDisplay.style.opacity = colorInput.value;
            fontColorDisplay.style.opacity = colorInput.value;

            break;
          default:
            console.log(`error in switch.`);
        }
      });

      let foregroundStyles = window.getComputedStyle(foregroundColorDisplay);
      console.log('foregroundStyles computed color is ', foregroundStyles.getPropertyValue('color'));
      console.log('foregroundStyles computed background color is', foregroundStyles.getPropertyValue('background-color'));
      let fontTextStyles = window.getComputedStyle(fontTextDisplay);
      console.log('Font Text computed color is ', foregroundStyles.getPropertyValue('color'));
      // console.log('computed line-height is', foregroundStyles.getPropertyValue('line-height'));
      let fontColorStyles = window.getComputedStyle(fontColorDisplay);
      console.log('computed background color is ', fontColorStyles.getPropertyValue('background-color'));
      // console.log('computed line-height is', foregroundStyles.getPropertyValue('line-height'));


      let fgComputed = calculateColor(bgColor, fgColor, fgOpacity || 1);
      let fontComputed = calculateColor(bgColor, fontColor, fgOpacity);

      document.getElementById('foregroundColorComputed').innerText = '#' + fgComputed.toUpperCase();
      document.getElementById('fontColorComputed').innerText = '#' + fontComputed.toUpperCase();
      // backgroundColorComputed  fontTextComputed

      // https://webaim.org/resources/contrastchecker/?fcolor=999999&bcolor=FFFFFF&api

    }

    function calculateColor(backgroundHex, colorHex, opacity = 1) {
      console.log(backgroundHex, colorHex, opacity);
      const bg = parseColor(backgroundHex);
      const color = parseColor(colorHex);
      const resultColor = getColor(bg, color, opacity);

      const computedColor = resultColor.r.toString(16)
              + resultColor.g.toString(16)
              + resultColor.b.toString(16);
      console.log('background', backgroundHex, 'color', colorHex, 'opacity', opacity, 'computed color', computedColor);
      return computedColor;
    }

    // function calculate() {
    //   const bg = parseColor(background.value);
    //   const color = parseColor(document.getElementById('color').value);
    //   const resultColor = getColor(bg, color, opacity.value);
    //
    //   return resultColor.r.toString(16)
    //           + resultColor.g.toString(16)
    //           + resultColor.b.toString(16);
    // }


    function parseColor(clr) {
      if (!clr) throw new Error('Color must not be empty!')
      if (clr[0]=='#') clr = clr.slice(1);
      if (clr.length != 3 && clr.length != 6) throw new Error('Incorrect color value!');
      return clr.length == 3
              ? {
                r: parseInt(clr[0]+clr[0], 16),
                g: parseInt(clr[1]+clr[1], 16),
                b: parseInt(clr[2]+clr[2], 16)
              }
              : {
                r: parseInt(clr.slice(0,2), 16),
                g: parseInt(clr.slice(2,4), 16),
                b: parseInt(clr.slice(4,6), 16)
              };
    }

    function getColor(bg, clr, op) {
      // check if <== 1
      console.log('op', op);
      op = op * 100;
      console.log('op * 100', op * 100);
      return {
        r: getClr(bg.r, clr.r, op),
        g: getClr(bg.g, clr.g, op),
        b: getClr(bg.b, clr.b, op)
      }
    }

    function getClr(bg, clr, op) {
      op = op / 100;
      return Math.round(bg + op * (clr - bg));
    }

    function handleChange(e) {
      console.log(e.currentTarget.value, e);
      // log.textContent = `The field's value is
      //   ${e.target.value.length} character(s) long.`;
      updateColors();
    }

    /*
<style>
  h3::after {
    content: ' rocks!';
  }
</style>

<h3>Generated content</h3>

<script4>
  var h3 = document.querySelector('h3');
  var result = getComputedStyle(h3, ':after').content;

  console.log('the generated content is: ', result); // returns ' rocks!'
</script4>
 */



  </script>
  <style>
  /*
    In most browsers, the placeholder text is grey. To change this, style the placeholder with the non-standard ::placeholder selector. Note that Firefox adds a lower opacity to the placeholder, so we use opacity: 1 to fix this.
    Example */
    .styled-placeholder::placeholder { /* Chrome, Firefox, Modern Edge, Safari 10.1+ */
      color: red;
      opacity: 1; /* Firefox */
    }

    .mybackground {
      /*background-color: #000000;*/
      background-color: #FFFFFF;
    }

    .mycolor {
      width: 200px;
      height: 100px;
      /*background-color: #FFFFFF;*/
      background-color: #000000;
      border: 2px;
    }
    .myopacity {
      width: 150px;
      height: 50px;
      /*opacity: 0.3;*/
      /*opacity: 0.7; */
      opacity: 0.4;
      color: #9e9e9e;

    }

    .myhooverbackground {
      width: 150px;
      height: 50px;
      background-color: #757575;
    }

    .colorcontrast {

    }

    .colorentry {
      display: inline-block;
    }

    .backgroundcolor {
      width: 300px;
      height: 200px;
      border: 1px solid #000000;
      margin: 5px;
      padding: 5px;
    }

    .foregroundcolor {
      width: 250px;
      height: 150px;
      border: 1px solid #FF0000;
      margin: 5px;
      padding: 5px;
      color: #FF0000;
    }

    .fontcolor {
      width: 190px;
      height: 40px;
      margin: 5px;
      padding: 5px;
      border: 1px solid #FFFF00;
    }

  </style>
</head>
<body>
<div id="container">
  <div id="chewycenter">
    <h1>CT.Net Accessibility Colour Contrast Test Page</h1>
    <a href="a11yindex.html" id="topAnchor">Back to A11y Index</a>
    <form id="colorContrast" class="colorcontrast">
      <div class="colorentry">
        <label for="backgroundColor">Background Color:<br> HEX: #FFFFFF</label><br>
        <input type="text" id="backgroundColor" name="backgroundColor" value="#FFFFFF">
      </div>
      <div class="colorentry">
        <label for="foregroundColor">Foreground Color:<br> HEX: #000000</label><br>
        <input type="text" id="foregroundColor" name="foregroundColor" value="#000000">
      </div>
      <div class="colorentry">
        <label for="foregroundOpacity">Foreground Opacity:<br> Decimal: 0.7</label><br>
        <input type="text" id="foregroundOpacity" name="foregroundOpacity" value="0.4">
      </div>
      <div class="colorentry">
        <label for="fontColor">Font Color:<br> HEX: #AAAAAA</label><br>
        <input type="text" id="fontColor" name="fontColor" value="#AAAAAA">
      </div>
      <div class="colorentry">
        <label for="fontOpacity">Font Opacity:<br> Decimal: 0.7</label><br>
        <input type="text" id="fontOpacity" name="fontOpacity">
      </div><br>
      <input type="reset">
      <div id="backgroundColorDisplay" class="backgroundcolor">Background Color <span id="backgroundColorComputed"></span>
        <div id="foregroundColorDisplay" class="foregroundcolor">Foreground Color <span id="foregroundColorComputed"></span>
          <div id="fontTextDisplay" class="fontcolor">This is the text <span id="fontTextComputed"></span></div>
          <div id="fontColorDisplay" class="fontcolor">This is the text color <span id="fontColorComputed"></span></div>
        </div>
      </div>
    </form>
    <div class="mybackground">Background
      <div class="mycolor">Color</div>
      <div class="mycolor myopacity">Opacity</div>
      <div class="myhooverbackground">Hover Background</div>
    </div>
  </div>
</div>
</body>
<script>
  const colorContrast = document.getElementById('colorContrast');
  const colorInputs = colorContrast.querySelectorAll('input[type="text"]');

  console.log(colorContrast);
  console.log(colorInputs);

  colorInputs.forEach(function(colorInput) {
    console.log(colorInput);
    colorInput.onchange = handleChange;
  });

  updateColors();
</script>
</html>